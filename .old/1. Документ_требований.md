## О чём задание

Настроить отказоустойчивую инфраструктуру в Yandex Cloud с помощью Terraform: две виртуальные машины, таргет‑группа и сетевой балансировщик нагрузки (NLB) с HTTP‑healthcheck. Затем установить Nginx на обе ВМ и проверить доступность через балансировщик.

## Конкретные требования

### Требование 1

**История пользователя:** Как *DevOps‑инженер*, я хочу автоматизированно создавать *две идентичные виртуальные машины* через Terraform, чтобы обеспечить резервирование вычислительного слоя.

#### Критерии успеха

1. **КОГДА** выполняю `terraform apply`, **ТОГДА** в YC появляются 2 ВМ с одинаковыми параметрами.
2. **КОГДА** проверяю ресурсы в консоли YC, **ТОГДА** вижу обе ВМ в статусе *RUNNING*.

### Требование 2

**История пользователя:** Как *DevOps‑инженер*, я хочу объединить эти ВМ в *таргет‑группу* для балансировщика, чтобы он знал, куда слать трафик.

#### Критерии успеха

1. **КОГДА** смотрю таргет‑группу, **ТОГДА** обе ВМ присутствуют в списке targets.
2. **КОГДА** меняюсь IP ВМ, **ТОГДА** изменения автоматически отражаются в таргет‑группе после `terraform apply`.

### Требование 3

**История пользователя:** Как *DevOps‑инженер*, я хочу создать *сетевой балансировщик нагрузки* (NLB), который слушает порт 80 и проверяет здоровье через HTTP, чтобы распределять трафик и отсекать неработающие инстансы.

#### Критерии успеха

1. **КОГДА** балансировщик создан, **ТОГДА** его статус — *Active*.
2. **КОГДА** healthcheck запрашивает `/` на порт 80 ВМ, **ТОГДА** обе ВМ получают статус *healthy*.

### Требование 4

**История пользователя:** Как *DevOps‑инженер*, я хочу, чтобы на каждой ВМ был установлен и запущен *Nginx* на порту 80, чтобы балансировщик мог отдавать HTTP‑контент.

#### Критерии успеха

1. **КОГДА** подключаюсь к любой ВМ по SSH и выполняю `systemctl status nginx`, **ТОГДА** вижу *active (running)*.
2. **КОГДА** открываю `curl http://<PRIVATE_IP_VM>`, **ТОГДА** получаю дефолтную страницу Nginx.

### Требование 5

**История пользователя:** Как *пользователь*, я хочу обращаться по *публичному IP балансировщика* и получать страницу Nginx без ошибок, чтобы убедиться в работоспособности кластера.

#### Критерии успеха

1. **КОГДА** выполняю `curl http://<PUBLIC_IP_NLB>`, **ТОГДА** получаю HTTP 200 и дефолтную страницу Nginx.
2. **КОГДА** перезапускаю одну из ВМ, **ТОГДА** балансировщик продолжает отдавать страницу, не прерывая сервис.

## Дополнительные допущения и ограничения

* Terraform ≥ 1.0, провайдер `yandex` ≥ 0.95.
* Используется один subnet/zone, если иное не указано.
* ОС ВМ: Ubuntu 22.04 LTS (cloud‑image).
* Доступ по SSH через ваш публичный ключ.
* Все переменные Terraform вынесены в `variables.tf` и `terraform.tfvars`.
